(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4569:(e,t,r)=>{Promise.resolve().then(r.bind(r,4836))},4836:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var l=r(5155),n=r(2115),a=r(5125);let i={tick:{label:"Per Tick",durationMs:3e4,snapshotIntervalMs:50},"1m":{label:"1 Minute",durationMs:6e4,snapshotIntervalMs:100},"5m":{label:"5 Minute",durationMs:3e5,snapshotIntervalMs:500},"15m":{label:"15 Minute",durationMs:9e5,snapshotIntervalMs:1500},"1h":{label:"1 Hour",durationMs:36e5,snapshotIntervalMs:6e3},"4h":{label:"4 Hours",durationMs:144e5,snapshotIntervalMs:24e3},"1d":{label:"1 Day",durationMs:864e5,snapshotIntervalMs:144e3}};function s(e){let{symbol:t,category:r="linear"}=e,a=(0,n.useRef)(null),[s,o]=(0,n.useState)("tick"),[c,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(null),f=(0,n.useRef)(s);(0,n.useEffect)(()=>{f.current=s},[s]);let m=(0,n.useRef)({bids:new Map,asks:new Map,midPrice:0,maxSize:0}),x=(0,n.useRef)([]),b=(0,n.useRef)([]),g=(0,n.useRef)(!0),p=(0,n.useRef)({priceRange:50,playheadX:0});return(0,n.useEffect)(()=>{let e,l,n,a=m.current,s=()=>{g.current=!0,h(null),(e=new WebSocket("wss://stream.bytick.com/v5/public/".concat(r))).onopen=()=>{u(!0),h(null),e.send(JSON.stringify({op:"subscribe",args:["orderbook.50.".concat(t),"publicTrade.".concat(t)]})),l=setInterval(()=>{e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({op:"ping"}))},2e4)},e.onclose=()=>{u(!1),clearInterval(l),n=setTimeout(s,3e3)},e.onerror=t=>{console.warn("WebSocket error:",t),h("Connection error. Retrying..."),e.close()},e.onmessage=e=>{let r=JSON.parse(e.data);if(r.topic==="orderbook.50.".concat(t)){let e=r.data,t=m.current;if("snapshot"===r.type){if(t.bids.clear(),t.asks.clear(),e.b.forEach(e=>{let[r,l]=e;return t.bids.set(parseFloat(r),parseFloat(l))}),e.a.forEach(e=>{let[r,l]=e;return t.asks.set(parseFloat(r),parseFloat(l))}),g.current&&e.b.length>0){let t=parseFloat(e.b[0][0]);p.current.priceRange=Math.max(.01,Math.min(1e3,.002*t)),g.current=!1}}else if("delta"===r.type){var l,n;null==(l=e.b)||l.forEach(e=>{let[r,l]=e,n=parseFloat(r),a=parseFloat(l);0===a?t.bids.delete(n):t.bids.set(n,a)}),null==(n=e.a)||n.forEach(e=>{let[r,l]=e,n=parseFloat(r),a=parseFloat(l);0===a?t.asks.delete(n):t.asks.set(n,a)})}let a=0,s=1/0,o=0;for(let[e,r]of t.bids.entries())e>a&&(a=e),r>o&&(o=r);for(let[e,r]of t.asks.entries())e<s&&(s=e),r>o&&(o=r);a>0&&s<1/0?t.midPrice=(a+s)/2:a>0?t.midPrice=a:s<1/0&&(t.midPrice=s),t.maxSize=o;let c=Date.now();if(c-(x.current.length>0?x.current[x.current.length-1].time:0)>=i[f.current].snapshotIntervalMs){let e=new Map;for(let[r,l]of t.bids.entries())e.set(r,l);for(let[r,l]of t.asks.entries())e.set(r,l);x.current.push({time:c,levels:e,maxSize:t.maxSize,midPrice:t.midPrice}),x.current.length>2e3&&(x.current=x.current.slice(-2e3))}}else r.topic==="publicTrade.".concat(t)&&(r.data.forEach(e=>{b.current.push({time:e.T,price:parseFloat(e.p),volume:parseFloat(e.v),isBuyerMaker:"Sell"===e.S})}),b.current.length>5e3&&(b.current=b.current.slice(-5e3)))}};return s(),()=>{clearTimeout(n),clearInterval(l),e&&e.close(),a.bids.clear(),a.asks.clear(),x.current=[],b.current=[]}},[t,r]),(0,n.useEffect)(()=>{let e,t=a.current;if(!t)return;let r=t.getContext("2d",{alpha:!1});if(!r)return;let l=(e,t)=>{let r=Math.min(1,e/(t||1));if(r<.25){let e=Math.floor(r/.25*255);return"rgb(0,0,".concat(e,")")}if(r<.5){let e=Math.floor((r-.25)/.25*255),t=255-Math.floor((r-.25)/.25*255);return"rgb(".concat(e,",0,").concat(t,")")}if(r<.75){let e=Math.floor((r-.5)/.25*255);return"rgb(255,".concat(e,",0)")}{let e=Math.floor((r-.75)/.25*255);return"rgb(255,255,".concat(e,")")}},n=()=>{let a=t.clientWidth,s=t.clientHeight;if(0===a||0===s){e=requestAnimationFrame(n);return}p.current.playheadX=.8*a;let o=p.current.playheadX,u=o/i[f.current].durationMs;r.fillStyle="#050505",r.fillRect(0,0,a,s);let d=m.current;if(0===d.midPrice){r.fillStyle="rgba(255, 255, 255, 0.5)",r.font='14px "JetBrains Mono", monospace',r.textAlign="center",r.fillText(c?"Waiting for orderbook data...":"Connecting to Bybit WebSocket...",a/2,s/2),e=requestAnimationFrame(n);return}let h=d.midPrice-p.current.priceRange,g=d.midPrice+p.current.priceRange,y=e=>s-(e-h)/(g-h)*s,v=Date.now(),w=v-o/u;x.current=x.current.filter(e=>e.time>=w),r.beginPath();let k=!0;for(let e=0;e<x.current.length;e++){let t=x.current[e],n=o-(v-t.time)*u;if(n<0)continue;let a=Math.max(1,(e<x.current.length-1?o-(v-x.current[e+1].time)*u:o)-n);for(let[e,i]of t.levels.entries()){if(e<h||e>g)continue;let s=y(e);r.fillStyle=l(i,t.maxSize),r.fillRect(n,s-2,a+.5,4)}let i=y(t.midPrice);k?(r.moveTo(n,i),k=!1):r.lineTo(n,i)}for(let[e,t]of(k||(r.lineTo(o,y(d.midPrice)),r.strokeStyle="rgba(255, 255, 255, 0.6)",r.lineWidth=1.5,r.stroke()),d.bids.entries())){if(e<h||e>g)continue;let l=y(e),n=Math.min(1,t/(d.maxSize||1)),i=Math.max(2,(a-o)*n);r.fillStyle="rgba(0, 255, 0, ".concat(.3+.7*n,")"),r.fillRect(o,l-1,i,2)}for(let[e,t]of d.asks.entries()){if(e<h||e>g)continue;let l=y(e),n=Math.min(1,t/(d.maxSize||1)),i=Math.max(2,(a-o)*n);r.fillStyle="rgba(255, 0, 0, ".concat(.3+.7*n,")"),r.fillRect(o,l-1,i,2)}for(let e of(b.current=b.current.filter(e=>e.time>=w),b.current)){if(e.price<h||e.price>g)continue;let t=o-(v-e.time)*u,l=y(e.price),n=Math.max(3,Math.min(30,5*Math.sqrt(e.volume)));r.beginPath(),r.arc(t,l,n,0,2*Math.PI),r.fillStyle=e.isBuyerMaker?"rgba(255, 50, 50, 0.6)":"rgba(50, 255, 50, 0.6)",r.fill(),r.lineWidth=1,r.strokeStyle=e.isBuyerMaker?"rgb(255, 0, 0)":"rgb(0, 255, 0)",r.stroke()}r.beginPath(),r.moveTo(o,0),r.lineTo(o,s),r.strokeStyle="rgba(255, 255, 255, 0.8)",r.lineWidth=1,r.setLineDash([4,4]),r.stroke(),r.setLineDash([]);let S=y(d.midPrice);r.beginPath(),r.moveTo(0,S),r.lineTo(a,S),r.strokeStyle="rgba(255, 255, 255, 0.3)",r.stroke();let M=1;p.current.priceRange<.01?M=5:p.current.priceRange<.1?M=4:p.current.priceRange<1?M=3:p.current.priceRange<10?M=2:p.current.priceRange>1e3&&(M=0),r.fillStyle="white",r.font='12px "JetBrains Mono", monospace',r.fillText("Mid: ".concat(d.midPrice.toFixed(M)),10,20),r.fillText("Max Vol: ".concat(d.maxSize.toFixed(2)),10,40),r.textAlign="right",r.textBaseline="middle";let j=p.current.priceRange/5;for(let e=h;e<=g;e+=j){let t=y(e);r.fillText(e.toFixed(M),a-10,t)}r.textAlign="left",r.textBaseline="alphabetic",e=requestAnimationFrame(n)};return n(),()=>cancelAnimationFrame(e)},[c]),(0,n.useEffect)(()=>{let e=()=>{if(a.current){let e=a.current.parentElement;if(e){let t=window.devicePixelRatio||1;a.current.width=e.clientWidth*t,a.current.height=e.clientHeight*t;let r=a.current.getContext("2d");r&&(r.setTransform(1,0,0,1,0,0),r.scale(t,t)),a.current.style.width="".concat(e.clientWidth,"px"),a.current.style.height="".concat(e.clientHeight,"px")}}};return window.addEventListener("resize",e),e(),setTimeout(e,100),()=>window.removeEventListener("resize",e)},[]),(0,l.jsxs)("div",{className:"w-full h-full relative bg-[#050505] overflow-hidden",onWheel:e=>{e.preventDefault();let t=e.deltaY>0?1.1:.9;p.current.priceRange=Math.max(1e-4,Math.min(1e5,p.current.priceRange*t))},children:[(0,l.jsx)("canvas",{ref:a,className:"block w-full h-full cursor-crosshair"}),(0,l.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col items-end gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 bg-black/50 p-2 rounded-lg backdrop-blur-sm border border-white/10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(c?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{className:"text-xs font-mono text-white/70",children:c?"Connected":"Disconnected"})]}),(0,l.jsx)("div",{className:"h-4 w-px bg-white/20"}),(0,l.jsx)("select",{className:"bg-zinc-900 text-white px-3 py-1.5 rounded text-sm font-mono outline-none border border-white/10 hover:border-white/30 transition-colors",value:s,onChange:e=>o(e.target.value),children:Object.entries(i).map(e=>{let[t,{label:r}]=e;return(0,l.jsx)("option",{value:t,children:r},t)})})]}),d&&(0,l.jsx)("div",{className:"bg-red-500/20 text-red-400 border border-red-500/50 px-3 py-1.5 rounded text-xs font-mono backdrop-blur-sm",children:d})]}),(0,l.jsx)("div",{className:"absolute bottom-4 left-4 text-xs font-mono text-white/50 bg-black/50 px-2 py-1 rounded backdrop-blur-sm",children:"Scroll to Zoom Y-Axis"})]})}let o=e=>{let t=e.slice(-1),r=parseInt(e.slice(0,-1));switch(t){case"m":return 60*r*1e3;case"h":return 60*r*6e4;case"d":return 24*r*36e5;case"w":return 7*r*864e5;default:return 6e4}},c=new Map,u=e=>{let{symbol:t,interval:r,category:i="linear"}=e,s=(0,n.useRef)(null),u=(0,n.useRef)(null),[d,h]=(0,n.useState)(r),[f,m]=(0,n.useState)(!0),x=(0,n.useRef)(!0),b=(0,n.useRef)([]),g=(0,n.useRef)(1),p=(0,n.useRef)({x:0,y:0}),y=(0,n.useRef)({x:100,y:16}),v=(0,n.useRef)(!1),w=(0,n.useRef)(null),k=(0,n.useRef)({x:0,y:0}),S=(0,n.useRef)("Initializing...");(0,n.useEffect)(()=>{let e,r=!0;b.current=[],S.current="Initializing...",y.current={x:100,y:16},p.current={x:0,y:0},m(!0),x.current=!0;let l=new WebSocket("wss://stream.bytick.com/v5/public/".concat(i));return l.onopen=()=>{S.current="WS Connected, waiting for trades...",l.send(JSON.stringify({op:"subscribe",args:["publicTrade.".concat(t)]})),e=window.setInterval(()=>{l.readyState===WebSocket.OPEN&&l.send(JSON.stringify({op:"ping"}))},2e4)},l.onerror=e=>{console.warn("WebSocket error:",e),S.current="WebSocket Error. Retrying..."},l.onclose=()=>{S.current="WebSocket Disconnected."},(async()=>{try{S.current="Fetching tick size...";let e=await a.A.get("https://api.bytick.com/v5/market/tickers?category=".concat(i,"&symbol=").concat(t)),n=parseFloat(e.data.result.list[0].lastPrice),s=.01;n>1e4?s="1m"===d||"5m"===d?10:"15m"===d||"1h"===d?50:100:n>1e3?s="1m"===d||"5m"===d?1:"15m"===d||"1h"===d?5:10:n>100&&(s=.1),g.current=s;let u="1";"1m"===d?u="1":"5m"===d?u="5":"15m"===d?u="15":"1h"===d?u="60":"4h"===d?u="240":"1d"===d?u="D":"1w"===d&&(u="W");let h="".concat(i,"_").concat(t,"_").concat(d),f=c.get(h);if(f||(f=new Map,c.set(h,f),S.current="Fetching historical klines...",(await a.A.get("https://api.bytick.com/v5/market/kline?category=".concat(i,"&symbol=").concat(t,"&interval=").concat(u,"&limit=100"))).data.result.list.reverse().forEach(e=>{let t=parseInt(e[0]);f.set(t,{time:t,open:parseFloat(e[1]),high:parseFloat(e[2]),low:parseFloat(e[3]),close:parseFloat(e[4]),volume:parseFloat(e[5]),levels:new Map,maxVol:0,totalVol:0})}),S.current="Fetching recent trades...",(await a.A.get("https://api.bytick.com/v5/market/recent-trade?category=".concat(i,"&symbol=").concat(t,"&limit=1000"))).data.result.list.reverse().forEach(e=>{let t=o(d),r=Math.floor(parseInt(e.time)/t)*t,l=parseFloat(e.price),n=parseFloat(e.size),a="Sell"===e.side,i=Math.floor(l/s)*s;if(f.has(r)){let e=f.get(r);e.totalVol+=n,e.levels.has(i)||e.levels.set(i,{bid:0,ask:0});let t=e.levels.get(i);a?t.bid+=n:t.ask+=n;let l=t.bid+t.ask;l>e.maxVol&&(e.maxVol=l)}})),r){if(b.current=Array.from(f.values()).sort((e,t)=>e.time-t.time),b.current.length>0){let e=b.current[b.current.length-1];p.current.y=e.close}l.readyState===WebSocket.OPEN&&(S.current="Connected and syncing...")}}catch(e){console.warn("Footprint init error:",e),S.current="Error: ".concat(e instanceof Error?e.message:"Failed to load data")}})(),l.onmessage=e=>{let r=JSON.parse(e.data);if(r.topic==="publicTrade.".concat(t)){r.data.forEach(e=>{let r=parseFloat(e.p),l=parseFloat(e.v),n="Sell"===e.S,a=g.current,s=Math.floor(r/a)*a;["1m","5m","15m","1h","4h","1d","1w"].forEach(a=>{let u="".concat(i,"_").concat(t,"_").concat(a),d=c.get(u);if(!d)return;let h=o(a),f=Math.floor(parseInt(e.T)/h)*h;d.has(f)||d.set(f,{time:f,open:r,high:r,low:r,close:r,volume:0,levels:new Map,maxVol:0,totalVol:0});let m=d.get(f);m.close=r,r>m.high&&(m.high=r),r<m.low&&(m.low=r),m.volume+=l,m.totalVol+=l,m.levels.has(s)||m.levels.set(s,{bid:0,ask:0});let x=m.levels.get(s);n?x.bid+=l:x.ask+=l;let b=x.bid+x.ask;b>m.maxVol&&(m.maxVol=b)})});let e="".concat(i,"_").concat(t,"_").concat(d),l=c.get(e);l&&(b.current=Array.from(l.values()).sort((e,t)=>e.time-t.time),b.current.length>200&&(b.current=b.current.slice(-200))),S.current="Live"}},()=>{r=!1,clearInterval(e),l.close()}},[t,d]),(0,n.useEffect)(()=>{let e,t=s.current,r=u.current;if(!t||!r)return;let l=t.getContext("2d");if(!l)return;let n=()=>{(t.width!==r.clientWidth||t.height!==r.clientHeight)&&(t.width=r.clientWidth,t.height=r.clientHeight),l.clearRect(0,0,t.width,t.height),l.fillStyle="#050505",l.fillRect(0,0,t.width,t.height);let a=b.current;if(0===a.length){l.fillStyle="rgba(255, 255, 255, 0.5)",l.font="14px monospace",l.textAlign="center",l.fillText(S.current,t.width/2,t.height/2),e=requestAnimationFrame(n);return}if(x.current&&a.length>0){p.current.x=0;let e=a[a.length-1].close;p.current.y+=(e-p.current.y)*.1}let i=y.current.x,s=y.current.y,o=g.current,c=t.height/2,u=e=>c-(e-p.current.y)/o*s;l.fillStyle="Live"===S.current?"#00ff00":S.current.includes("Error")||S.current.includes("Disconnect")?"#ff0000":"#ff9800",l.beginPath(),l.arc(20,20,5,0,2*Math.PI),l.fill(),l.fillStyle="#ffffff",l.font="12px sans-serif",l.textAlign="left",l.fillText(S.current,32,24),l.strokeStyle="rgba(255, 255, 255, 0.03)",l.lineWidth=1,a.forEach((e,r)=>{let n=t.width-(a.length-r)*(i+10)+p.current.x-60;if(n+i<0||n>t.width)return;let c=n+i/2,d=e.close>=e.open?"#26a69a":"#ef5350",h=u(e.high),f=u(e.low);l.strokeStyle=d,l.lineWidth=2,l.beginPath(),l.moveTo(c,h),l.lineTo(c,f),l.stroke();let m=u(e.open),x=u(e.close),b=Math.min(m,x),g=Math.max(m,x);if(l.fillStyle=d,i<40){let e=Math.max(.8*i,2);l.fillRect(c-e/2,b,e,Math.max(g-b,2))}else l.fillRect(c-3,b,6,Math.max(g-b,2));i>=40&&e.levels.forEach((r,n)=>{var a,d;let h=u(n);if(h<-s||h>t.height+s)return;let f=Math.round((n+o)*1e5)/1e5,m=Math.round((n-o)*1e5)/1e5,x=(null==(a=e.levels.get(f))?void 0:a.ask)||0,b=(null==(d=e.levels.get(m))?void 0:d.bid)||0,g=r.bid>3*x&&r.bid>0,p=r.ask>3*b&&r.ask>0,y=Math.min(1,r.bid/(e.maxVol||1)*2.5),v=Math.min(1,r.ask/(e.maxVol||1)*2.5),w=i/2-8,k=w*y;l.fillStyle="rgba(239, 83, 80, 0.3)",l.fillRect(c-4-k,h-s/2+1,k,s-2),l.fillStyle="rgba(38, 166, 154, 0.3)",l.fillRect(c+4,h-s/2+1,w*v,s-2);let S=e=>0===e?"0":e>1e3?(e/1e3).toFixed(1)+"k":e.toFixed(1),M=S(r.bid),j=S(r.ask);l.textBaseline="middle",s>=12&&i>=60&&(l.textAlign="right",l.font=g?"bold 11px monospace":"11px monospace",l.fillStyle=g?"#ffeb3b":r.bid>0?"#ffffff":"#787b86",l.fillText(M,c-6,h),l.textAlign="left",l.font=p?"bold 11px monospace":"11px monospace",l.fillStyle=p?"#ffeb3b":r.ask>0?"#ffffff":"#787b86",l.fillText(j,c+6,h)),g&&(l.strokeStyle="rgba(255, 235, 59, 0.8)",l.lineWidth=1,l.strokeRect(c-4-w,h-s/2+1,w,s-2)),p&&(l.strokeStyle="rgba(255, 235, 59, 0.8)",l.lineWidth=1,l.strokeRect(c+4,h-s/2+1,w,s-2))})}),l.fillStyle="#1e222d",l.fillRect(0,t.height-20,t.width-60,20),l.fillStyle="#787b86",l.font="10px sans-serif",l.textAlign="center",l.textBaseline="middle",a.forEach((e,r)=>{let n=t.width-(a.length-r)*(i+10)+p.current.x-60;if(n+i<0||n>t.width)return;let s=new Date(e.time),o="".concat(s.getHours(),":").concat(s.getMinutes().toString().padStart(2,"0"));(d.endsWith("d")||d.endsWith("w"))&&(o="".concat(s.getDate(),"/").concat(s.getMonth()+1)),l.fillText(o,n+i/2,t.height-10)}),l.fillStyle="#1e222d",l.fillRect(t.width-60,0,60,t.height),l.fillStyle="#d1d4dc",l.font="12px monospace",l.textAlign="left",l.textBaseline="middle";let h=p.current.y-c/s*o,f=p.current.y+c/s*o,m=o*Math.ceil(t.height/s/20),v=Math.floor(h/m)*m;for(let e=v;e<=f;e+=m){let r=u(e);l.fillText(e.toFixed(2*(o<1)),t.width-55,r),l.strokeStyle="rgba(255, 255, 255, 0.05)",l.beginPath(),l.moveTo(0,r),l.lineTo(t.width-60,r),l.stroke()}if(a.length>0){let e=a[a.length-1].close,r=u(e);l.strokeStyle="#2962FF",l.setLineDash([5,5]),l.lineWidth=1,l.beginPath(),l.moveTo(0,r),l.lineTo(t.width-60,r),l.stroke(),l.setLineDash([]),l.fillStyle="#2962FF",l.fillRect(t.width-60,r-10,60,20),l.fillStyle="#ffffff",l.textAlign="left",l.fillText(e.toFixed(2*(o<1)),t.width-55,r)}e=requestAnimationFrame(n)};return n(),()=>cancelAnimationFrame(e)},[d]);let M=()=>{v.current=!1,w.current=null,u.current&&(u.current.style.cursor="crosshair")};return(0,l.jsxs)("div",{className:"w-full h-full flex flex-col bg-[#050505] text-white overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-4 py-2 border-b border-white/10 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("h2",{className:"text-sm font-bold text-gray-300",children:["Footprint Chart (",t,")"]}),(0,l.jsxs)("select",{className:"bg-[#111] text-gray-300 px-2 py-1 text-xs rounded border border-white/10 outline-none hover:border-white/20 transition-colors",value:d,onChange:e=>h(e.target.value),children:[(0,l.jsx)("option",{value:"1m",children:"1 Minute"}),(0,l.jsx)("option",{value:"5m",children:"5 Minutes"}),(0,l.jsx)("option",{value:"15m",children:"15 Minutes"}),(0,l.jsx)("option",{value:"1h",children:"1 Hour"}),(0,l.jsx)("option",{value:"4h",children:"4 Hours"}),(0,l.jsx)("option",{value:"1d",children:"1 Day"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Drag to pan, Scroll to move, Ctrl+Scroll to zoom"}),(0,l.jsx)("button",{onClick:()=>{x.current=!f,m(!f)},className:"px-3 py-1 text-xs rounded font-medium transition-colors ".concat(f?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:f?"Auto Scroll: ON":"Auto Scroll: OFF"})]})]}),(0,l.jsx)("div",{ref:u,className:"flex-1 relative",onMouseDown:e=>{var t;let r=null==(t=u.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;l>r.width-60?w.current="zoomY":n>r.height-20?w.current="zoomX":w.current="pan",v.current=!0,k.current={x:e.clientX,y:e.clientY},x.current=!1,m(!1)},onMouseMove:e=>{var t;let r=null==(t=u.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;if(!v.current)return void(l>r.width-60?u.current.style.cursor="ns-resize":n>r.height-20?u.current.style.cursor="ew-resize":u.current.style.cursor="crosshair");let a=e.clientX-k.current.x,i=e.clientY-k.current.y;if("pan"===w.current){u.current.style.cursor="grabbing",p.current.x+=a;let e=i/y.current.y*g.current;p.current.y+=e}else"zoomY"===w.current?y.current.y=Math.max(1,Math.min(100,y.current.y*(1-.01*i))):"zoomX"===w.current&&(y.current.x=Math.max(10,Math.min(300,y.current.x*(1+.01*a))));k.current={x:e.clientX,y:e.clientY}},onMouseUp:M,onMouseLeave:M,onWheel:e=>{var t;e.preventDefault();let r=null==(t=u.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;if(x.current=!1,m(!1),l>r.width-60){let t=e.deltaY>0?.9:1.1;y.current.y=Math.max(1,Math.min(100,y.current.y*t))}else if(n>r.height-20){let t=e.deltaY>0?.9:1.1;y.current.x=Math.max(10,Math.min(300,y.current.x*t))}else{let t=e.deltaY>0?.9:1.1;y.current.x=Math.max(10,Math.min(300,y.current.x*t))}},children:(0,l.jsx)("canvas",{ref:s,className:"absolute inset-0 block"})})]})};var d=r(9540),h=r(6651),f=r(5229),m=r(906),x=r(5664);function b(){let[e,t]=(0,n.useState)("heatmap"),[r,i]=(0,n.useState)(!1),[o,c]=(0,n.useState)("BTCUSDT"),[b,g]=(0,n.useState)("linear"),[p,y]=(0,n.useState)([{symbol:"BTCUSDT",category:"linear"},{symbol:"ETHUSDT",category:"linear"},{symbol:"XAUUSDT",category:"linear"}]),[v,w]=(0,n.useState)(!1),[k,S]=(0,n.useState)("");(0,n.useEffect)(()=>{Promise.all([a.A.get("https://api.bytick.com/v5/market/instruments-info?category=linear"),a.A.get("https://api.bytick.com/v5/market/instruments-info?category=spot")]).then(e=>{let[t,r]=e,l=new Map;r.data&&r.data.result&&r.data.result.list&&r.data.result.list.forEach(e=>{l.set(e.symbol,{symbol:e.symbol,category:"spot"})}),t.data&&t.data.result&&t.data.result.list&&t.data.result.list.forEach(e=>{l.set(e.symbol,{symbol:e.symbol,category:"linear"})});let n=Array.from(l.values());n.sort((e,t)=>e.symbol.localeCompare(t.symbol)),y(n)}).catch(e=>console.error("Failed to fetch symbols",e))},[]);let M=p.filter(e=>e.symbol.toLowerCase().includes(k.toLowerCase()));return(0,l.jsxs)("main",{className:"w-screen h-screen bg-[#050505] text-white flex flex-col overflow-hidden",children:[(0,l.jsxs)("header",{className:"px-6 py-3 border-b border-white/10 flex justify-between items-center bg-black/40 backdrop-blur-md z-10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("button",{onClick:()=>i(!0),className:"p-1.5 hover:bg-white/10 rounded transition-colors text-gray-400 hover:text-white",children:(0,l.jsx)(d.A,{size:20})}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-emerald-500 rounded-sm shadow-[0_0_10px_rgba(16,185,129,0.5)]"}),(0,l.jsx)("h1",{className:"text-lg font-medium tracking-tight font-sans",children:"heatmap"===e?"Order Flow Heatmap":"Footprint Chart"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("button",{onClick:()=>w(!0),className:"bg-zinc-900 border border-white/10 hover:border-white/30 text-white px-4 py-1.5 rounded-md text-sm font-mono transition-colors flex items-center gap-2",children:[(0,l.jsx)("span",{children:o}),(0,l.jsx)(h.A,{size:14,className:"text-gray-400"})]}),(0,l.jsx)("div",{className:"text-xs font-mono text-zinc-400 tracking-wider uppercase hidden sm:block",children:"Bybit V5 WebSocket"})]})]}),(0,l.jsx)("div",{className:"flex-1 relative",children:"heatmap"===e?(0,l.jsx)(s,{symbol:o,category:b}):(0,l.jsx)(u,{symbol:o,interval:"1m",category:b})}),r&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center",onClick:()=>i(!1),children:(0,l.jsxs)("div",{className:"bg-[#131722] border border-white/10 rounded-xl w-80 overflow-hidden shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center bg-black/20",children:[(0,l.jsx)("h2",{className:"font-semibold text-gray-200",children:"Select View"}),(0,l.jsx)("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:(0,l.jsx)(f.A,{size:18})})]}),(0,l.jsxs)("div",{className:"p-2 flex flex-col gap-1",children:[(0,l.jsxs)("button",{onClick:()=>{t("heatmap"),i(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ".concat("heatmap"===e?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)(m.A,{size:18}),(0,l.jsx)("span",{className:"font-medium",children:"Order Flow Heatmap"})]}),(0,l.jsxs)("button",{onClick:()=>{t("footprint"),i(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ".concat("footprint"===e?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)(x.A,{size:18}),(0,l.jsx)("span",{className:"font-medium",children:"Footprint Chart"})]})]})]})}),v&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center",onClick:()=>w(!1),children:(0,l.jsxs)("div",{className:"bg-[#131722] border border-white/10 rounded-xl w-96 max-h-[80vh] flex flex-col overflow-hidden shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center bg-black/20",children:[(0,l.jsx)("h2",{className:"font-semibold text-gray-200",children:"Select Pair"}),(0,l.jsx)("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-white",children:(0,l.jsx)(f.A,{size:18})})]}),(0,l.jsx)("div",{className:"p-3 border-b border-white/10",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(h.A,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),(0,l.jsx)("input",{type:"text",placeholder:"Search pairs (e.g. XAUUSDT)",className:"w-full bg-black/40 border border-white/10 rounded-lg py-2 pl-9 pr-4 text-sm text-white outline-none focus:border-blue-500 transition-colors",value:k,onChange:e=>S(e.target.value),autoFocus:!0})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-2",children:M.length>0?(0,l.jsx)("div",{className:"grid grid-cols-2 gap-1",children:M.map(e=>(0,l.jsxs)("button",{onClick:()=>{c(e.symbol),g(e.category),w(!1)},className:"flex justify-between items-center px-3 py-2 rounded-md text-sm font-mono transition-colors ".concat(o===e.symbol?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)("span",{children:e.symbol}),(0,l.jsx)("span",{className:"text-[10px] text-gray-500 uppercase px-1.5 py-0.5 bg-white/5 rounded",children:e.category})]},"".concat(e.symbol,"-").concat(e.category)))}):(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500 text-sm",children:['No pairs found matching "',k,'"']})})]})})]})}}},e=>{e.O(0,[284,441,255,358],()=>e(e.s=4569)),_N_E=e.O()}]);
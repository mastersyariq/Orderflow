(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{463:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var l=r(5155),n=r(2115),i=r(5125);let a={tick:{label:"Per Tick",durationMs:3e4,snapshotIntervalMs:50},"1m":{label:"1 Minute",durationMs:6e4,snapshotIntervalMs:100},"5m":{label:"5 Minute",durationMs:3e5,snapshotIntervalMs:500},"15m":{label:"15 Minute",durationMs:9e5,snapshotIntervalMs:1500},"1h":{label:"1 Hour",durationMs:36e5,snapshotIntervalMs:6e3},"4h":{label:"4 Hours",durationMs:144e5,snapshotIntervalMs:24e3},"1d":{label:"1 Day",durationMs:864e5,snapshotIntervalMs:144e3}};function s(e){let{symbol:t,category:r="linear"}=e,i=(0,n.useRef)(null),[s,o]=(0,n.useState)("tick"),[c,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(null),[f,x]=(0,n.useState)(0),m=(0,n.useRef)(s),b=(0,n.useRef)({x:0,y:0,isHovering:!1});(0,n.useEffect)(()=>{m.current=s},[s]);let g=(0,n.useRef)({bids:new Map,asks:new Map,midPrice:0,maxSize:0}),p=(0,n.useRef)([]),y=(0,n.useRef)([]),v=(0,n.useRef)(!0),w=(0,n.useRef)({priceRange:50,playheadX:0});return(0,n.useEffect)(()=>{let e,l,n,i=!0,s=g.current,o=()=>{i&&(v.current=!0,h(null),(e=new WebSocket("wss://stream.bytick.com/v5/public/".concat(r))).onopen=()=>{u(!0),h(null),e.send(JSON.stringify({op:"subscribe",args:["orderbook.50.".concat(t),"publicTrade.".concat(t)]})),l=setInterval(()=>{e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({op:"ping"}))},2e4)},e.onclose=()=>{u(!1),clearInterval(l),n=setTimeout(o,3e3)},e.onerror=t=>{console.warn("WebSocket error:",t),h("Connection error. Retrying..."),e.close()},e.onmessage=e=>{if(!i)return;let r=JSON.parse(e.data);if(r.topic==="orderbook.50.".concat(t)){let e=r.data,t=g.current;if("snapshot"===r.type){if(t.bids.clear(),t.asks.clear(),e.b.forEach(e=>{let[r,l]=e;return t.bids.set(parseFloat(r),parseFloat(l))}),e.a.forEach(e=>{let[r,l]=e;return t.asks.set(parseFloat(r),parseFloat(l))}),v.current&&e.b.length>0){let t=parseFloat(e.b[0][0]);w.current.priceRange=Math.max(.01,Math.min(1e3,.002*t)),v.current=!1}}else if("delta"===r.type){var l,n;null==(l=e.b)||l.forEach(e=>{let[r,l]=e,n=parseFloat(r),i=parseFloat(l);0===i?t.bids.delete(n):t.bids.set(n,i)}),null==(n=e.a)||n.forEach(e=>{let[r,l]=e,n=parseFloat(r),i=parseFloat(l);0===i?t.asks.delete(n):t.asks.set(n,i)})}let i=0,s=1/0,o=0;for(let[e,r]of t.bids.entries())e>i&&(i=e),r>o&&(o=r);for(let[e,r]of t.asks.entries())e<s&&(s=e),r>o&&(o=r);i>0&&s<1/0?t.midPrice=(i+s)/2:i>0?t.midPrice=i:s<1/0&&(t.midPrice=s),t.maxSize=o;let c=Date.now();if(c-(p.current.length>0?p.current[p.current.length-1].time:0)>=a[m.current].snapshotIntervalMs){let e=new Map;for(let[r,l]of t.bids.entries())e.set(r,l);for(let[r,l]of t.asks.entries())e.set(r,l);p.current.push({time:c,levels:e,maxSize:t.maxSize,midPrice:t.midPrice}),p.current.length>2e3&&(p.current=p.current.slice(-2e3))}}else r.topic==="publicTrade.".concat(t)&&(r.data.forEach(e=>{y.current.push({time:e.T,price:parseFloat(e.p),volume:parseFloat(e.v),isBuyerMaker:"Sell"===e.S})}),y.current.length>5e3&&(y.current=y.current.slice(-5e3)))})};return o(),()=>{i=!1,clearTimeout(n),clearInterval(l),e&&e.close(),s.bids.clear(),s.asks.clear(),s.midPrice=0,s.maxSize=0,p.current=[],y.current=[]}},[t,r,f]),(0,n.useEffect)(()=>{let e,t=i.current;if(!t)return;let r=t.getContext("2d",{alpha:!1});if(!r)return;let l=(e,t)=>{let r=Math.min(1,e/(t||1));if(r<.25){let e=Math.floor(r/.25*255);return"rgb(0,0,".concat(e,")")}if(r<.5){let e=Math.floor((r-.25)/.25*255),t=255-Math.floor((r-.25)/.25*255);return"rgb(".concat(e,",0,").concat(t,")")}if(r<.75){let e=Math.floor((r-.5)/.25*255);return"rgb(255,".concat(e,",0)")}{let e=Math.floor((r-.75)/.25*255);return"rgb(255,255,".concat(e,")")}},n=()=>{let i=t.clientWidth,s=t.clientHeight;if(0===i||0===s){e=requestAnimationFrame(n);return}w.current.playheadX=.8*i;let o=w.current.playheadX,u=o/a[m.current].durationMs;r.fillStyle="#050505",r.fillRect(0,0,i,s);let d=g.current;if(0===d.midPrice&&0===p.current.length){r.fillStyle="rgba(255, 255, 255, 0.5)",r.font='14px "JetBrains Mono", monospace',r.textAlign="center",r.fillText(c?"Waiting for orderbook data...":"Connecting to Bybit WebSocket...",i/2,s/2),e=requestAnimationFrame(n);return}let h=d.midPrice||(p.current.length>0?p.current[p.current.length-1].midPrice:0),f=h-w.current.priceRange,x=h+w.current.priceRange,v=[];for(let[e,t]of d.bids.entries())e>=f&&e<=x&&v.push(t);for(let[e,t]of d.asks.entries())e>=f&&e<=x&&v.push(t);let k=d.maxSize||1;if(v.length>0){v.sort((e,t)=>e-t);let e=Math.floor(.95*v.length);k=v[e]||v[v.length-1]}0===k&&(k=1);let S=e=>s-(e-f)/(x-f)*s,j=Date.now(),M=j-o/u;p.current=p.current.filter(e=>e.time>=M),r.beginPath();let N=!0;for(let e=0;e<p.current.length;e++){let t=p.current[e],n=o-(j-t.time)*u;if(n<0)continue;let i=Math.max(1,(e<p.current.length-1?o-(j-p.current[e+1].time)*u:o)-n);for(let[e,a]of t.levels.entries()){if(e<f||e>x)continue;let t=S(e);r.fillStyle=l(a,k),r.fillRect(n,t-2,i+.5,4)}let a=S(t.midPrice);N?(r.moveTo(n,a),N=!1):r.lineTo(n,a)}for(let[e,t]of(!N&&d.midPrice>0?(r.lineTo(o,S(d.midPrice)),r.strokeStyle="rgba(255, 255, 255, 0.6)",r.lineWidth=1.5,r.stroke()):N||(r.strokeStyle="rgba(255, 255, 255, 0.6)",r.lineWidth=1.5,r.stroke()),d.bids.entries())){if(e<f||e>x)continue;let l=S(e),n=Math.min(1,t/k),a=Math.max(2,(i-o)*n);r.fillStyle="rgba(0, 255, 0, ".concat(.3+.7*n,")"),r.fillRect(o,l-1,a,2)}for(let[e,t]of d.asks.entries()){if(e<f||e>x)continue;let l=S(e),n=Math.min(1,t/k),a=Math.max(2,(i-o)*n);r.fillStyle="rgba(255, 0, 0, ".concat(.3+.7*n,")"),r.fillRect(o,l-1,a,2)}for(let e of(y.current=y.current.filter(e=>e.time>=M),y.current)){if(e.price<f||e.price>x)continue;let t=o-(j-e.time)*u,l=S(e.price),n=Math.max(3,Math.min(30,5*Math.sqrt(e.volume)));r.beginPath(),r.arc(t,l,n,0,2*Math.PI),r.fillStyle=e.isBuyerMaker?"rgba(255, 50, 50, 0.6)":"rgba(50, 255, 50, 0.6)",r.fill(),r.lineWidth=1,r.strokeStyle=e.isBuyerMaker?"rgb(255, 0, 0)":"rgb(0, 255, 0)",r.stroke()}r.beginPath(),r.moveTo(o,0),r.lineTo(o,s),r.strokeStyle="rgba(255, 255, 255, 0.8)",r.lineWidth=1,r.setLineDash([4,4]),r.stroke(),r.setLineDash([]);let R=S(d.midPrice);r.beginPath(),r.moveTo(0,R),r.lineTo(i,R),r.strokeStyle="rgba(255, 255, 255, 0.3)",r.stroke();let F=1;w.current.priceRange<.01?F=5:w.current.priceRange<.1?F=4:w.current.priceRange<1?F=3:w.current.priceRange<10?F=2:w.current.priceRange>1e3&&(F=0),r.fillStyle="white",r.font='12px "JetBrains Mono", monospace',r.fillText("Mid: ".concat(h.toFixed(F)),10,20),r.fillText("Max Vol: ".concat(k.toFixed(2)),10,40),r.textAlign="right",r.textBaseline="middle";let T=w.current.priceRange/5;for(let e=f;e<=x;e+=T){let t=S(e);r.fillText(e.toFixed(F),i-10,t)}if(h>0){let e=h.toFixed(F),t=r.measureText(e).width+20,l=S(h);r.fillStyle="#2563eb",r.fillRect(i-t,l-12,t,24),r.fillStyle="white",r.textAlign="center",r.fillText(e,i-t/2,l)}if(r.textAlign="left",r.textBaseline="alphabetic",b.current.isHovering&&b.current.x>=o){let e=b.current.y,t=null,l=4;for(let[r,n]of d.asks.entries()){if(r<f||r>x)continue;let i=S(r),a=Math.abs(i-e);a<l&&(l=a,t={type:"Ask",price:r,size:n,y:i})}for(let[r,n]of d.bids.entries()){if(r<f||r>x)continue;let i=S(r),a=Math.abs(i-e);a<l&&(l=a,t={type:"Bid",price:r,size:n,y:i})}if(t){let e="".concat(t.type,": ").concat(t.size.toFixed(2));r.font='12px "JetBrains Mono", monospace';let l=r.measureText(e).width+12,n=b.current.x-l-10;n<o&&(n=b.current.x+10);let i=t.y-11;r.fillStyle="rgba(10, 10, 10, 0.9)",r.strokeStyle="Bid"===t.type?"rgba(74, 222, 128, 0.5)":"rgba(248, 113, 113, 0.5)",r.lineWidth=1,r.beginPath(),r.roundRect(n,i,l,22,4),r.fill(),r.stroke(),r.fillStyle="Bid"===t.type?"#4ade80":"#f87171",r.textAlign="left",r.textBaseline="middle",r.fillText(e,n+6,i+11)}}e=requestAnimationFrame(n)};return n(),()=>cancelAnimationFrame(e)},[c]),(0,n.useEffect)(()=>{let e=()=>{if(i.current){let e=i.current.parentElement;if(e){let t=window.devicePixelRatio||1;i.current.width=e.clientWidth*t,i.current.height=e.clientHeight*t;let r=i.current.getContext("2d");r&&(r.setTransform(1,0,0,1,0,0),r.scale(t,t)),i.current.style.width="".concat(e.clientWidth,"px"),i.current.style.height="".concat(e.clientHeight,"px")}}};return window.addEventListener("resize",e),e(),setTimeout(e,100),()=>window.removeEventListener("resize",e)},[]),(0,l.jsxs)("div",{className:"w-full h-full relative bg-[#050505] overflow-hidden",onWheel:e=>{e.preventDefault();let t=e.deltaY>0?1.1:.9;w.current.priceRange=Math.max(1e-4,Math.min(1e5,w.current.priceRange*t))},onMouseMove:e=>{var t;let r=null==(t=i.current)?void 0:t.getBoundingClientRect();r&&(b.current={x:e.clientX-r.left,y:e.clientY-r.top,isHovering:!0})},onMouseLeave:()=>{b.current.isHovering=!1},onMouseEnter:()=>b.current.isHovering=!0,children:[(0,l.jsx)("canvas",{ref:i,className:"block w-full h-full cursor-crosshair"}),(0,l.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col items-end gap-2 z-10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 bg-black/50 p-2 rounded-lg backdrop-blur-sm border border-white/10",children:[(0,l.jsxs)("button",{onClick:()=>{g.current.bids.clear(),g.current.asks.clear(),g.current.midPrice=0,g.current.maxSize=0,p.current=[],y.current=[],v.current=!0,x(e=>e+1)},className:"bg-zinc-900 px-3 py-1.5 rounded text-xs font-mono outline-none border border-white/10 hover:border-white/30 transition-colors text-white/70 flex items-center gap-2",title:"Refresh Screen",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),(0,l.jsx)("path",{d:"M3 3v5h5"})]}),"Refresh"]}),(0,l.jsx)("div",{className:"h-4 w-px bg-white/20"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(c?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{className:"text-xs font-mono text-white/70",children:c?"Connected":"Disconnected"})]}),(0,l.jsx)("div",{className:"h-4 w-px bg-white/20"}),(0,l.jsx)("select",{className:"bg-zinc-900 text-white px-3 py-1.5 rounded text-sm font-mono outline-none border border-white/10 hover:border-white/30 transition-colors",value:s,onChange:e=>o(e.target.value),children:Object.entries(a).map(e=>{let[t,{label:r}]=e;return(0,l.jsx)("option",{value:t,children:r},t)})})]}),d&&(0,l.jsx)("div",{className:"bg-red-500/20 text-red-400 border border-red-500/50 px-3 py-1.5 rounded text-xs font-mono backdrop-blur-sm",children:d})]}),(0,l.jsx)("div",{className:"absolute bottom-4 left-4 text-xs font-mono text-white/50 bg-black/50 px-2 py-1 rounded backdrop-blur-sm",children:"Scroll to Zoom Y-Axis"})]})}let o=e=>{let t=e.slice(-1),r=parseInt(e.slice(0,-1));switch(t){case"m":return 60*r*1e3;case"h":return 60*r*6e4;case"d":return 24*r*36e5;case"w":return 7*r*864e5;default:return 6e4}},c=new Map,u=(e,t)=>{if(e>1e4)return"1m"===t||"5m"===t?10:"15m"===t||"1h"===t?50:100;if(e>1e3)return"1m"===t||"5m"===t?1:"15m"===t||"1h"===t?5:10;if(e>100)return .1;if(e>10)return .01;if(e>1)return .001;else if(e>.1)return 1e-4;return 1e-5},d=e=>{let{symbol:t,interval:r,category:a="linear"}=e,s=(0,n.useRef)(null),d=(0,n.useRef)(null),[h,f]=(0,n.useState)(r),[x,m]=(0,n.useState)(!0),b=(0,n.useRef)(!0),g=(0,n.useRef)([]),p=(0,n.useRef)(1),y=(0,n.useRef)({x:0,y:0}),v=(0,n.useRef)({x:100,y:16}),w=(0,n.useRef)(!1),k=(0,n.useRef)(null),S=(0,n.useRef)({x:0,y:0}),j=(0,n.useRef)("Initializing..."),M=(0,n.useRef)(h);(0,n.useEffect)(()=>{M.current=h},[h]),(0,n.useEffect)(()=>{let e,r=new WebSocket("wss://stream.bytick.com/v5/public/".concat(a));return r.onopen=()=>{"WebSocket Disconnected."===j.current&&(j.current="WS Reconnected, waiting for trades..."),r.send(JSON.stringify({op:"subscribe",args:["publicTrade.".concat(t)]})),e=window.setInterval(()=>{r.readyState===WebSocket.OPEN&&r.send(JSON.stringify({op:"ping"}))},2e4)},r.onerror=e=>{console.warn("WebSocket error:",e),j.current="WebSocket Error. Retrying..."},r.onclose=()=>{j.current="WebSocket Disconnected."},r.onmessage=e=>{let r=JSON.parse(e.data);if(r.topic==="publicTrade.".concat(t)){r.data.forEach(e=>{let r=parseFloat(e.p),l=parseFloat(e.v),n="Sell"===e.S;["1m","5m","15m","1h","4h","1d","1w"].forEach(i=>{let s="".concat(a,"_").concat(t,"_").concat(i),d=c.get(s);if(!d)return;let h=o(i),f=Math.floor(parseInt(e.T)/h)*h,x=u(r,i),m=Math.floor(r/x)*x;d.has(f)||d.set(f,{time:f,open:r,high:r,low:r,close:r,volume:0,levels:new Map,maxVol:0,totalVol:0});let b=d.get(f);b.close=r,r>b.high&&(b.high=r),r<b.low&&(b.low=r),b.volume+=l,b.totalVol+=l,b.levels.has(m)||b.levels.set(m,{bid:0,ask:0});let g=b.levels.get(m);n?g.bid+=l:g.ask+=l;let p=g.bid+g.ask;p>b.maxVol&&(b.maxVol=p)})});let e="".concat(a,"_").concat(t,"_").concat(M.current),l=c.get(e);l&&(g.current=Array.from(l.values()).sort((e,t)=>e.time-t.time),g.current.length>200&&(g.current=g.current.slice(-200))),"Live"!==j.current&&(j.current="Live")}},()=>{clearInterval(e),r.close()}},[t,a]),(0,n.useEffect)(()=>{let e=!0;return j.current="Initializing...",v.current={x:100,y:16},y.current={x:0,y:0},m(!0),b.current=!0,(async()=>{try{j.current="Fetching tick size...";let r=await i.A.get("https://api.bytick.com/v5/market/tickers?category=".concat(a,"&symbol=").concat(t)),l=parseFloat(r.data.result.list[0].lastPrice),n=u(l,h);p.current=n;let s="1";"1m"===h?s="1":"5m"===h?s="5":"15m"===h?s="15":"1h"===h?s="60":"4h"===h?s="240":"1d"===h?s="D":"1w"===h&&(s="W");let d="".concat(a,"_").concat(t,"_").concat(h),f=c.get(d);if(f||(f=new Map,c.set(d,f),j.current="Fetching historical klines...",(await i.A.get("https://api.bytick.com/v5/market/kline?category=".concat(a,"&symbol=").concat(t,"&interval=").concat(s,"&limit=100"))).data.result.list.reverse().forEach(e=>{let t=parseInt(e[0]);f.set(t,{time:t,open:parseFloat(e[1]),high:parseFloat(e[2]),low:parseFloat(e[3]),close:parseFloat(e[4]),volume:parseFloat(e[5]),levels:new Map,maxVol:0,totalVol:0})}),j.current="Fetching recent trades...",(await i.A.get("https://api.bytick.com/v5/market/recent-trade?category=".concat(a,"&symbol=").concat(t,"&limit=1000"))).data.result.list.reverse().forEach(e=>{let t=o(h),r=Math.floor(parseInt(e.time)/t)*t,l=parseFloat(e.price),i=parseFloat(e.size),a="Sell"===e.side,s=Math.floor(l/n)*n;if(f.has(r)){let e=f.get(r);e.totalVol+=i,e.levels.has(s)||e.levels.set(s,{bid:0,ask:0});let t=e.levels.get(s);a?t.bid+=i:t.ask+=i;let l=t.bid+t.ask;l>e.maxVol&&(e.maxVol=l)}})),e){if(g.current=Array.from(f.values()).sort((e,t)=>e.time-t.time),g.current.length>0){let e=g.current[g.current.length-1];y.current.y=e.close}j.current="Live"}}catch(e){console.warn("Footprint init error:",e),j.current="Error: ".concat(e instanceof Error?e.message:"Failed to load data")}})(),()=>{e=!1}},[t,a,h]),(0,n.useEffect)(()=>{let e,t=s.current,r=d.current;if(!t||!r)return;let l=t.getContext("2d");if(!l)return;let n=()=>{(t.width!==r.clientWidth||t.height!==r.clientHeight)&&(t.width=r.clientWidth,t.height=r.clientHeight),l.clearRect(0,0,t.width,t.height),l.fillStyle="#050505",l.fillRect(0,0,t.width,t.height);let i=g.current;if(0===i.length){l.fillStyle="rgba(255, 255, 255, 0.5)",l.font="14px monospace",l.textAlign="center",l.fillText(j.current,t.width/2,t.height/2),e=requestAnimationFrame(n);return}if(b.current&&i.length>0){y.current.x=0;let e=i[i.length-1].close;y.current.y+=(e-y.current.y)*.1}let a=v.current.x,s=v.current.y,o=p.current,c=t.height/2,u=e=>c-(e-y.current.y)/o*s;l.fillStyle="Live"===j.current?"#00ff00":j.current.includes("Error")||j.current.includes("Disconnect")?"#ff0000":"#ff9800",l.beginPath(),l.arc(20,20,5,0,2*Math.PI),l.fill(),l.fillStyle="#ffffff",l.font="12px sans-serif",l.textAlign="left",l.fillText(j.current,32,24),l.strokeStyle="rgba(255, 255, 255, 0.03)",l.lineWidth=1,i.forEach((e,r)=>{let n=t.width-(i.length-r)*(a+10)+y.current.x-60;if(n+a<0||n>t.width)return;let c=n+a/2,d=e.close>=e.open?"#26a69a":"#ef5350",h=u(e.high),f=u(e.low);l.strokeStyle=d,l.lineWidth=2,l.beginPath(),l.moveTo(c,h),l.lineTo(c,f),l.stroke();let x=u(e.open),m=u(e.close),b=Math.min(x,m),g=Math.max(x,m);if(l.fillStyle=d,a<40){let e=Math.max(.8*a,2);l.fillRect(c-e/2,b,e,Math.max(g-b,2))}else l.fillRect(c-3,b,6,Math.max(g-b,2));a>=40&&e.levels.forEach((r,n)=>{var i,d;let h=u(n);if(h<-s||h>t.height+s)return;let f=Math.round((n+o)*1e5)/1e5,x=Math.round((n-o)*1e5)/1e5,m=(null==(i=e.levels.get(f))?void 0:i.ask)||0,b=(null==(d=e.levels.get(x))?void 0:d.bid)||0,g=r.bid>3*m&&r.bid>0,p=r.ask>3*b&&r.ask>0,y=Math.min(1,r.bid/(e.maxVol||1)*2.5),v=Math.min(1,r.ask/(e.maxVol||1)*2.5),w=a/2-8,k=w*y;l.fillStyle="rgba(239, 83, 80, 0.3)",l.fillRect(c-4-k,h-s/2+1,k,s-2),l.fillStyle="rgba(38, 166, 154, 0.3)",l.fillRect(c+4,h-s/2+1,w*v,s-2);let S=e=>0===e?"0":e>1e3?(e/1e3).toFixed(1)+"k":e.toFixed(1),j=S(r.bid),M=S(r.ask);l.textBaseline="middle",s>=12&&a>=60&&(l.textAlign="right",l.font=g?"bold 11px monospace":"11px monospace",l.fillStyle=g?"#ffeb3b":r.bid>0?"#ffffff":"#787b86",l.fillText(j,c-6,h),l.textAlign="left",l.font=p?"bold 11px monospace":"11px monospace",l.fillStyle=p?"#ffeb3b":r.ask>0?"#ffffff":"#787b86",l.fillText(M,c+6,h)),g&&(l.strokeStyle="rgba(255, 235, 59, 0.8)",l.lineWidth=1,l.strokeRect(c-4-w,h-s/2+1,w,s-2)),p&&(l.strokeStyle="rgba(255, 235, 59, 0.8)",l.lineWidth=1,l.strokeRect(c+4,h-s/2+1,w,s-2))})}),l.fillStyle="#1e222d",l.fillRect(0,t.height-20,t.width-60,20),l.fillStyle="#787b86",l.font="10px sans-serif",l.textAlign="center",l.textBaseline="middle",i.forEach((e,r)=>{let n=t.width-(i.length-r)*(a+10)+y.current.x-60;if(n+a<0||n>t.width)return;let s=new Date(e.time),o="".concat(s.getHours(),":").concat(s.getMinutes().toString().padStart(2,"0"));(h.endsWith("d")||h.endsWith("w"))&&(o="".concat(s.getDate(),"/").concat(s.getMonth()+1)),l.fillText(o,n+a/2,t.height-10)}),l.fillStyle="#1e222d",l.fillRect(t.width-60,0,60,t.height),l.fillStyle="#d1d4dc",l.font="12px monospace",l.textAlign="left",l.textBaseline="middle";let d=y.current.y-c/s*o,f=y.current.y+c/s*o,x=o*Math.ceil(t.height/s/20),m=Math.floor(d/x)*x;for(let e=m;e<=f;e+=x){let r=u(e);l.fillText(e.toFixed(2*(o<1)),t.width-55,r),l.strokeStyle="rgba(255, 255, 255, 0.05)",l.beginPath(),l.moveTo(0,r),l.lineTo(t.width-60,r),l.stroke()}if(i.length>0){let e=i[i.length-1].close,r=u(e);l.strokeStyle="#2962FF",l.setLineDash([5,5]),l.lineWidth=1,l.beginPath(),l.moveTo(0,r),l.lineTo(t.width-60,r),l.stroke(),l.setLineDash([]),l.fillStyle="#2962FF",l.fillRect(t.width-60,r-10,60,20),l.fillStyle="#ffffff",l.textAlign="left",l.fillText(e.toFixed(2*(o<1)),t.width-55,r)}e=requestAnimationFrame(n)};return n(),()=>cancelAnimationFrame(e)},[h]);let N=()=>{w.current=!1,k.current=null,d.current&&(d.current.style.cursor="crosshair")};return(0,l.jsxs)("div",{className:"w-full h-full flex flex-col bg-[#050505] text-white overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-4 py-2 border-b border-white/10 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("h2",{className:"text-sm font-bold text-gray-300",children:["Footprint Chart (",t,")"]}),(0,l.jsxs)("select",{className:"bg-[#111] text-gray-300 px-2 py-1 text-xs rounded border border-white/10 outline-none hover:border-white/20 transition-colors",value:h,onChange:e=>f(e.target.value),children:[(0,l.jsx)("option",{value:"1m",children:"1 Minute"}),(0,l.jsx)("option",{value:"5m",children:"5 Minutes"}),(0,l.jsx)("option",{value:"15m",children:"15 Minutes"}),(0,l.jsx)("option",{value:"1h",children:"1 Hour"}),(0,l.jsx)("option",{value:"4h",children:"4 Hours"}),(0,l.jsx)("option",{value:"1d",children:"1 Day"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Drag to pan, Scroll to move, Ctrl+Scroll to zoom"}),(0,l.jsx)("button",{onClick:()=>{b.current=!x,m(!x)},className:"px-3 py-1 text-xs rounded font-medium transition-colors ".concat(x?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:x?"Auto Scroll: ON":"Auto Scroll: OFF"})]})]}),(0,l.jsx)("div",{ref:d,className:"flex-1 relative",onMouseDown:e=>{var t;let r=null==(t=d.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;l>r.width-60?k.current="zoomY":n>r.height-20?k.current="zoomX":k.current="pan",w.current=!0,S.current={x:e.clientX,y:e.clientY},b.current=!1,m(!1)},onMouseMove:e=>{var t;let r=null==(t=d.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;if(!w.current)return void(l>r.width-60?d.current.style.cursor="ns-resize":n>r.height-20?d.current.style.cursor="ew-resize":d.current.style.cursor="crosshair");let i=e.clientX-S.current.x,a=e.clientY-S.current.y;if("pan"===k.current){d.current.style.cursor="grabbing",y.current.x+=i;let e=a/v.current.y*p.current;y.current.y+=e}else"zoomY"===k.current?v.current.y=Math.max(1,Math.min(100,v.current.y*(1-.01*a))):"zoomX"===k.current&&(v.current.x=Math.max(10,Math.min(300,v.current.x*(1+.01*i))));S.current={x:e.clientX,y:e.clientY}},onMouseUp:N,onMouseLeave:N,onWheel:e=>{var t;e.preventDefault();let r=null==(t=d.current)?void 0:t.getBoundingClientRect();if(!r)return;let l=e.clientX-r.left,n=e.clientY-r.top;if(b.current=!1,m(!1),l>r.width-60){let t=e.deltaY>0?.9:1.1;v.current.y=Math.max(1,Math.min(100,v.current.y*t))}else if(n>r.height-20){let t=e.deltaY>0?.9:1.1;v.current.x=Math.max(10,Math.min(300,v.current.x*t))}else{let t=e.deltaY>0?.9:1.1;v.current.x=Math.max(10,Math.min(300,v.current.x*t))}},children:(0,l.jsx)("canvas",{ref:s,className:"absolute inset-0 block"})})]})};function h(){let[e,t]=(0,n.useState)("about"),[r,i]=(0,n.useState)("Loading...");return(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("/Orderflow","/about.txt"));if(e.ok){let t=await e.text();i(t)}else i("Failed to load about.txt. Please ensure the file exists in the repository.")}catch(e){i("Error loading about.txt")}})()},[]),(0,l.jsxs)("div",{className:"flex w-full h-full bg-[#050505] text-white overflow-hidden",children:[(0,l.jsxs)("div",{className:"w-64 border-r border-white/10 bg-[#0a0a0a] flex flex-col shrink-0",children:[(0,l.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,l.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:"Settings"})}),(0,l.jsx)("div",{className:"flex-1 py-4",children:(0,l.jsx)("button",{onClick:()=>t("about"),className:"w-full text-left px-6 py-3 text-sm transition-colors ".concat("about"===e?"bg-blue-500/10 text-blue-400 border-r-2 border-blue-500":"text-white/70 hover:bg-white/5 hover:text-white"),children:"About"})})]}),(0,l.jsx)("div",{className:"flex-1 p-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"max-w-3xl",children:"about"===e&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-2xl font-semibold mb-6",children:"About"}),(0,l.jsx)("div",{className:"bg-[#111] border border-white/10 rounded-xl p-6 whitespace-pre-wrap font-mono text-sm text-white/80 leading-relaxed",children:r})]})})})]})}var f=r(5870),x=r(9451),m=r(6651),b=r(5229),g=r(906),p=r(5664);function y(){let[e,t]=(0,n.useState)("heatmap"),[r,a]=(0,n.useState)("heatmap"),[o,c]=(0,n.useState)(!1),[u,y]=(0,n.useState)("BTCUSDT"),[v,w]=(0,n.useState)("linear"),[k,S]=(0,n.useState)([{symbol:"BTCUSDT",category:"linear"},{symbol:"ETHUSDT",category:"linear"},{symbol:"XAUUSDT",category:"linear"}]),[j,M]=(0,n.useState)(!1),[N,R]=(0,n.useState)("");(0,n.useEffect)(()=>{Promise.all([i.A.get("https://api.bytick.com/v5/market/instruments-info?category=linear"),i.A.get("https://api.bytick.com/v5/market/instruments-info?category=spot")]).then(e=>{let[t,r]=e,l=new Map;r.data&&r.data.result&&r.data.result.list&&r.data.result.list.forEach(e=>{l.set(e.symbol,{symbol:e.symbol,category:"spot"})}),t.data&&t.data.result&&t.data.result.list&&t.data.result.list.forEach(e=>{l.set(e.symbol,{symbol:e.symbol,category:"linear"})});let n=Array.from(l.values());n.sort((e,t)=>e.symbol.localeCompare(t.symbol)),S(n)}).catch(e=>console.error("Failed to fetch symbols",e))},[]);let F=k.filter(e=>e.symbol.toLowerCase().includes(N.toLowerCase()));return(0,l.jsxs)("main",{className:"w-screen h-screen bg-[#050505] text-white flex flex-col overflow-hidden",children:[(0,l.jsxs)("header",{className:"px-6 py-3 border-b border-white/10 flex justify-between items-center bg-black/40 backdrop-blur-md z-10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("button",{onClick:()=>t("settings"===e?r:"settings"),className:"p-1.5 hover:bg-white/10 rounded transition-colors text-gray-400 hover:text-white",title:"Settings",children:(0,l.jsx)(f.A,{size:20})}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-emerald-500 rounded-sm shadow-[0_0_10px_rgba(16,185,129,0.5)]"}),(0,l.jsx)("h1",{className:"text-lg font-medium tracking-tight font-sans",children:"heatmap"===e?"Order Flow Heatmap":"footprint"===e?"Footprint Chart":"Settings"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("button",{onClick:()=>c(!0),className:"p-1.5 hover:bg-white/10 rounded transition-colors text-gray-400 hover:text-white",title:"Switch Terminal",children:(0,l.jsx)(x.A,{size:20})}),(0,l.jsxs)("button",{onClick:()=>M(!0),className:"bg-zinc-900 border border-white/10 hover:border-white/30 text-white px-4 py-1.5 rounded-md text-sm font-mono transition-colors flex items-center gap-2",children:[(0,l.jsx)("span",{children:u}),(0,l.jsx)(m.A,{size:14,className:"text-gray-400"})]}),(0,l.jsx)("div",{className:"text-xs font-mono text-zinc-400 tracking-wider uppercase hidden sm:block",children:"Bybit V5 WebSocket"})]})]}),(0,l.jsx)("div",{className:"flex-1 relative",children:"heatmap"===e?(0,l.jsx)(s,{symbol:u,category:v}):"footprint"===e?(0,l.jsx)(d,{symbol:u,interval:"1m",category:v}):(0,l.jsx)(h,{})}),o&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center",onClick:()=>c(!1),children:(0,l.jsxs)("div",{className:"bg-[#131722] border border-white/10 rounded-xl w-80 overflow-hidden shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center bg-black/20",children:[(0,l.jsx)("h2",{className:"font-semibold text-gray-200",children:"Select View"}),(0,l.jsx)("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-white",children:(0,l.jsx)(b.A,{size:18})})]}),(0,l.jsxs)("div",{className:"p-2 flex flex-col gap-1",children:[(0,l.jsxs)("button",{onClick:()=>{t("heatmap"),a("heatmap"),c(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ".concat("heatmap"===e?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)(g.A,{size:18}),(0,l.jsx)("span",{className:"font-medium",children:"Order Flow Heatmap"})]}),(0,l.jsxs)("button",{onClick:()=>{t("footprint"),a("footprint"),c(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ".concat("footprint"===e?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)(p.A,{size:18}),(0,l.jsx)("span",{className:"font-medium",children:"Footprint Chart"})]})]})]})}),j&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center",onClick:()=>M(!1),children:(0,l.jsxs)("div",{className:"bg-[#131722] border border-white/10 rounded-xl w-96 max-h-[80vh] flex flex-col overflow-hidden shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center bg-black/20",children:[(0,l.jsx)("h2",{className:"font-semibold text-gray-200",children:"Select Pair"}),(0,l.jsx)("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-white",children:(0,l.jsx)(b.A,{size:18})})]}),(0,l.jsx)("div",{className:"p-3 border-b border-white/10",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(m.A,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),(0,l.jsx)("input",{type:"text",placeholder:"Search pairs (e.g. XAUUSDT)",className:"w-full bg-black/40 border border-white/10 rounded-lg py-2 pl-9 pr-4 text-sm text-white outline-none focus:border-blue-500 transition-colors",value:N,onChange:e=>R(e.target.value),autoFocus:!0})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-2",children:F.length>0?(0,l.jsx)("div",{className:"grid grid-cols-2 gap-1",children:F.map(e=>(0,l.jsxs)("button",{onClick:()=>{y(e.symbol),w(e.category),M(!1)},className:"flex justify-between items-center px-3 py-2 rounded-md text-sm font-mono transition-colors ".concat(u===e.symbol?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-gray-300"),children:[(0,l.jsx)("span",{children:e.symbol}),(0,l.jsx)("span",{className:"text-[10px] text-gray-500 uppercase px-1.5 py-0.5 bg-white/5 rounded",children:e.category})]},"".concat(e.symbol,"-").concat(e.category)))}):(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500 text-sm",children:['No pairs found matching "',N,'"']})})]})})]})}},4569:(e,t,r)=>{Promise.resolve().then(r.bind(r,463))}},e=>{e.O(0,[856,441,255,358],()=>e(e.s=4569)),_N_E=e.O()}]);